
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voiplay REST API Documentation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1, h2, h3, h4 {
            color: #333;
        }
        h2 {
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
        }
        .endpoint {
            margin: 20px 0;
            padding: 15px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .endpoint h3 {
            margin-top: 0;
            color: #007bff;
        }
        .section {
            margin-bottom: 40px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #007bff;
            color: white;
        }
        .note {
            background-color: #e7f3fe;
            border-left: 4px solid #2196F3;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Voiplay REST API Documentation</h1>
    <p><strong>Base URL:</strong> <code>https://api.voiplay.uz/api/v3</code></p>
    <p><strong>Overview:</strong> This REST API provides access to anime, episode, user, favorite, search, and news data in the Voiplay platform. All responses are in JSON format. No authentication tokens are required.</p>

    <div class="section">
        <h2>Anime Endpoints</h2>
        
        <div class="endpoint">
            <h3>1. Get All Anime</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/anime</code></p>
            <p><strong>Description:</strong> Retrieves a list of all anime, with optional filters for status, release year, rating, and genres (max 50 results).</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>status</td><td>String</td><td>Filter by status: ongoing, completed, upcoming</td></tr>
                <tr><td>release_year</td><td>Integer</td><td>Filter by release year (e.g., 2025)</td></tr>
                <tr><td>rating</td><td>Float</td><td>Filter by minimum rating (e.g., 8.0)</td></tr>
                <tr><td>genres</td><td>String</td><td>Comma-separated genres (e.g., Action,Adventure)</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "anime": [
    {
      "id": "uuid",
      "title": "string",
      "slug": "string",
      "image": "string|null",
      "cover_image": "string|null",
      "description": "string|null",
      "studio": "string|null",
      "language": "string|null",
      "release_year": integer,
      "duration": "string|null",
      "status": "ongoing|completed|upcoming|null",
      "rating": number,
      "is_premium": boolean,
      "premium_unlock_at": "datetime|null",
      "views": integer,
      "created_at": "timestamp",
      "updated_at": "timestamp",
      "meta_title": "string|null",
      "meta_description": "string|null",
      "meta_keywords": "string|null"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>2. Get Ongoing Anime</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/anime/ongoing</code></p>
            <p><strong>Description:</strong> Retrieves a list of all anime with status "ongoing" (max 50 results).</p>
            <p><strong>Response:</strong></p>
            <pre>
{
  "anime": [
    {
      "id": "uuid",
      "title": "string",
      "slug": "string",
      "image": "string|null",
      "cover_image": "string|null",
      "description": "string|null",
      "studio": "string|null",
      "language": "string|null",
      "release_year": integer,
      "duration": "string|null",
      "status": "ongoing",
      "rating": number,
      "is_premium": boolean,
      "premium_unlock_at": "datetime|null",
      "views": integer,
      "created_at": "timestamp",
      "updated_at": "timestamp",
      "meta_title": "string|null",
      "meta_description": "string|null",
      "meta_keywords": "string|null"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>3. Get Anime by ID</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/anime/{id}</code></p>
            <p><strong>Description:</strong> Retrieves details of a specific anime by ID, including associated genres.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the anime</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "id": "uuid",
  "title": "string",
  "slug": "string",
  "image": "string|null",
  "cover_image": "string|null",
  "description": "string|null",
  "studio": "string|null",
  "language": "string|null",
  "release_year": integer,
  "duration": "string|null",
  "status": "ongoing|completed|upcoming|null",
  "rating": number,
  "is_premium": boolean,
  "premium_unlock_at": "datetime|null",
  "views": integer,
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "meta_title": "string|null",
  "meta_description": "string|null",
  "meta_keywords": "string|null",
  "genres": ["string", ...]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>4. Get Anime Episodes</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/anime/{id}/episodes</code></p>
            <p><strong>Description:</strong> Retrieves all episodes for a specific anime.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the anime</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "episodes": [
    {
      "id": "uuid",
      "anime_id": "uuid",
      "title": "string",
      "episode_number": integer|null,
      "description": "string|null",
      "video_url": "string",
      "thumbnail": "string|null",
      "duration": integer|null,
      "is_premium": boolean,
      "premium_unlock_at": "datetime|null",
      "views": integer,
      "likes": integer,
      "dislikes": integer,
      "comments_count": integer,
      "tags": "string|null",
      "release_date": "date|null",
      "language": "string",
      "episode_type": "standard|trailer|special",
      "is_official": boolean,
      "is_active": boolean,
      "content_maker_id": "uuid",
      "created_at": "timestamp",
      "updated_at": "timestamp",
      "slug": "string|null",
      "moderated_by": "uuid|null",
      "download_url": "string|null"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>5. Create Anime</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/anime</code></p>
            <p><strong>Description:</strong> Creates a new anime entry.</p>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "title": "string",
  "release_year": integer,
  "image": "string|null",
  "cover_image": "string|null",
  "description": "string|null",
  "studio": "string|null",
  "language": "string|null",
  "duration": "string|null",
  "status": "ongoing|completed|upcoming|null",
  "rating": number,
  "is_premium": boolean,
  "premium_unlock_at": "datetime|null",
  "meta_title": "string|null",
  "meta_description": "string|null",
  "meta_keywords": "string|null",
  "genres": ["string", ...]
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Anime created successfully",
  "id": "uuid"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>6. Update Anime</h3>
            <p><strong>Method:</strong> PUT</p>
            <p><strong>URL:</strong> <code>/anime/{id}</code></p>
            <p><strong>Description:</strong> Updates an existing anime entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the anime</td></tr>
            </table>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "title": "string",
  "image": "string|null",
  "cover_image": "string|null",
  "description": "string|null",
  "studio": "string|null",
  "language": "string|null",
  "release_year": integer,
  "duration": "string|null",
  "status": "ongoing|completed|upcoming|null",
  "rating": number,
  "is_premium": boolean,
  "premium_unlock_at": "datetime|null",
  "meta_title": "string|null",
  "meta_description": "string|null",
  "meta_keywords": "string|null",
  "genres": ["string", ...]
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Anime updated successfully"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>7. Delete Anime</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/anime/{id}</code></p>
            <p><strong>Description:</strong> Deletes an anime entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the anime</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Anime deleted successfully"
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>Episode Endpoints</h2>

        <div class="endpoint">
            <h3>8. Get All Episodes</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/episodes</code></p>
            <p><strong>Description:</strong> Retrieves a list of all episodes with their associated anime titles.</p>
            <p><strong>Response:</strong></p>
            <pre>
{
  "episodes": [
    {
      "id": "uuid",
      "anime_id": "uuid",
      "anime_title": "string",
      "title": "string",
      "episode_number": integer|null,
      "description": "string|null",
      "video_url": "string",
      "thumbnail": "string|null",
      "duration": integer|null,
      "is_premium": boolean,
      "premium_unlock_at": "datetime|null",
      "views": integer,
      "likes": integer,
      "dislikes": integer,
      "comments_count": integer,
      "tags": "string|null",
      "release_date": "date|null",
      "language": "string",
      "episode_type": "standard|trailer|special",
      "is_official": boolean,
      "is_active": boolean,
      "content_maker_id": "uuid",
      "created_at": "timestamp",
      "updated_at": "timestamp",
      "slug": "string|null",
      "moderated_by": "uuid|null",
      "download_url": "string|null"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>9. Get Episode by ID</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/episodes/{id}</code></p>
            <p><strong>Description:</strong> Retrieves details of a specific episode by ID, including the associated anime title.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the episode</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "id": "uuid",
  "anime_id": "uuid",
  "anime_title": "string",
  "title": "string",
  "episode_number": integer|null,
  "description": "string|null",
  "video_url": "string",
  "thumbnail": "string|null",
  "duration": integer|null,
  "is_premium": boolean,
  "premium_unlock_at": "datetime|null",
  "views": integer,
  "likes": integer,
  "dislikes": integer,
  "comments_count": integer,
  "tags": "string|null",
  "release_date": "date|null",
  "language": "string",
  "episode_type": "standard|trailer|special",
  "is_official": boolean,
  "is_active": boolean,
  "content_maker_id": "uuid",
  "created_at": "timestamp",
  "updated_at": "timestamp",
  "slug": "string|null",
  "moderated_by": "uuid|null",
  "download_url": "string|null"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>10. Create Episode</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/episodes</code></p>
            <p><strong>Description:</strong> Creates a new episode entry.</p>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "anime_id": "uuid",
  "title": "string",
  "video_url": "string",
  "episode_number": integer|null,
  "description": "string|null",
  "thumbnail": "string|null",
  "duration": integer|null,
  "is_premium": boolean,
  "premium_unlock_at": "datetime|null",
  "views": integer,
  "likes": integer,
  "dislikes": integer,
  "comments_count": integer,
  "tags": "string|null",
  "release_date": "date|null",
  "language": "string",
  "episode_type": "standard|trailer|special",
  "is_official": boolean,
  "is_active": boolean,
  "content_maker_id": "uuid",
  "moderated_by": "uuid|null",
  "download_url": "string|null"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Episode created successfully",
  "id": "uuid"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>11. Update Episode</h3>
            <p><strong>Method:</strong> PUT</p>
            <p><strong>URL:</strong> <code>/episodes/{id}</code></p>
            <p><strong>Description:</strong> Updates an existing episode entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the episode</td></tr>
            </table>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "anime_id": "uuid",
  "title": "string",
  "video_url": "string",
  "episode_number": integer|null,
  "description": "string|null",
  "thumbnail": "string|null",
  "duration": integer|null,
  "is_premium": boolean,
  "premium_unlock_at": "datetime|null",
  "views": integer,
  "likes": integer,
  "dislikes": integer,
  "comments_count": integer,
  "tags": "string|null",
  "release_date": "date|null",
  "language": "string",
  "episode_type": "standard|trailer|special",
  "is_official": boolean,
  "is_active": boolean,
  "content_maker_id": "uuid",
  "moderated_by": "uuid|null",
  "download_url": "string|null"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Episode updated successfully"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>12. Delete Episode</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/episodes/{id}</code></p>
            <p><strong>Description:</strong> Deletes an episode entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the episode</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Episode deleted successfully"
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>User Endpoints</h2>

        <div class="endpoint">
            <h3>13. Get All Users</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/users</code></p>
            <p><strong>Description:</strong> Retrieves a list of all users (excluding sensitive fields like passwords).</p>
            <p><strong>Response:</strong></p>
            <pre>
{
  "users": [
    {
      "id": "uuid",
      "username": "string",
      "email": "string",
      "avatar": "string|null",
      "bio": "string|null",
      "role": "user|moderator|admin",
      "premium_status": boolean,
      "premium_expires_at": "datetime|null",
      "created_at": "timestamp",
      "updated_at": "timestamp"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>14. Get User by ID</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/users/{id}</code></p>
            <p><strong>Description:</strong> Retrieves details of a specific user by ID (excluding sensitive fields).</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the user</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "id": "uuid",
  "username": "string",
  "email": "string",
  "avatar": "string|null",
  "bio": "string|null",
  "role": "user|moderator|admin",
  "premium_status": boolean,
  "premium_expires_at": "datetime|null",
  "created_at": "timestamp",
  "updated_at": "timestamp"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>15. Create User</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/users</code></p>
            <p><strong>Description:</strong> Creates a new user entry.</p>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "username": "string",
  "email": "string",
  "password": "string",
  "avatar": "string|null",
  "bio": "string|null",
  "role": "user|moderator|admin",
  "premium_status": boolean,
  "premium_expires_at": "datetime|null",
  "subscription_id": "uuid|null",
  "language": "string",
  "verification_token": "string|null",
  "reset_token": "string|null",
  "reset_token_expires": "datetime|null"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "User created successfully",
  "id": "uuid"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>16. Update User</h3>
            <p><strong>Method:</strong> PUT</p>
            <p><strong>URL:</strong> <code>/users/{id}</code></p>
            <p><strong>Description:</strong> Updates an existing user entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the user</td></tr>
            </table>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "username": "string",
  "email": "string",
  "password": "string",
  "avatar": "string|null",
  "bio": "string|null",
  "role": "user|moderator|admin",
  "premium_status": boolean,
  "premium_expires_at": "datetime|null",
  "subscription_id": "uuid|null",
  "language": "string",
  "verification_token": "string|null",
  "reset_token": "string|null",
  "reset_token_expires": "datetime|null"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "User updated successfully"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>17. Delete User</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/users/{id}</code></p>
            <p><strong>Description:</strong> Deletes a user entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the user</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "User deleted successfully"
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>Favorite Endpoints</h2>

        <div class="endpoint">
            <h3>18. Get All Favorites</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/favorites</code></p>
            <p><strong>Description:</strong> Retrieves a list of all favorites with associated user and anime details.</p>
            <p><strong>Response:</strong></p>
            <pre>
{
  "favorites": [
    {
      "id": "uuid",
      "user_id": "uuid",
      "username": "string",
      "anime_id": "uuid",
      "anime_title": "string",
      "created_at": "timestamp"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>19. Get Favorite by ID</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/favorites/{id}</code></p>
            <p><strong>Description:</strong> Retrieves details of a specific favorite by ID, including user and anime details.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the favorite</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "id": "uuid",
  "user_id": "uuid",
  "username": "string",
  "anime_id": "uuid",
  "anime_title": "string",
  "created_at": "timestamp"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>20. Get User Favorites</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/users/{id}/favorites</code></p>
            <p><strong>Description:</strong> Retrieves all favorites for a specific user.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the user</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "favorites": [
    {
      "id": "uuid",
      "user_id": "uuid",
      "username": "string",
      "anime_id": "uuid",
      "anime_title": "string",
      "created_at": "timestamp"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>21. Create Favorite</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/favorites</code></p>
            <p><strong>Description:</strong> Creates a new favorite entry.</p>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "user_id": "uuid",
  "anime_id": "uuid"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Favorite created successfully",
  "id": "uuid"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>22. Delete Favorite</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/favorites/{id}</code></p>
            <p><strong>Description:</strong> Deletes a favorite entry.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the favorite</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "Favorite deleted successfully"
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>Search Endpoint</h2>

        <div class="endpoint">
            <h3>23. Search</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/search?q={query}</code></p>
            <p><strong>Description:</strong> Searches for anime, episodes, and users matching the query term (limited to 10 results per category).</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>q</td><td>String</td><td>The search query term</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "anime": [
    {
      "id": "uuid",
      "title": "string",
      "slug": "string",
      "image": "string|null",
      "release_year": integer
    },
    ...
  ],
  "episodes": [
    {
      "id": "uuid",
      "anime_id": "uuid",
      "anime_title": "string",
      "title": "string",
      "episode_number": integer|null
    },
    ...
  ],
  "users": [
    {
      "id": "uuid",
      "username": "string",
      "email": "string",
      "avatar": "string|null"
    },
    ...
  ]
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>News Endpoints</h2>

        <div class="endpoint">
            <h3>24. Get All News</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/news</code></p>
            <p><strong>Description:</strong> Retrieves a list of all news articles with associated author names.</p>
            <p><strong>Response:</strong></p>
            <pre>
{
  "news": [
    {
      "id": "uuid",
      "title": "string",
      "slug": "string",
      "content": "string",
      "image": "string|null",
      "author_id": "uuid",
      "author_name": "string|null",
      "views": integer,
      "likes": integer,
      "dislikes": integer,
      "comments_count": integer,
      "is_published": boolean,
      "published_at": "datetime|null",
      "created_at": "timestamp",
      "updated_at": "timestamp"
    },
    ...
  ]
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>25. Get News by ID</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/news/{id}</code></p>
            <p><strong>Description:</strong> Retrieves details of a specific news article by ID, including author name.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the news article</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "id": "uuid",
  "title": "string",
  "slug": "string",
  "content": "string",
  "image": "string|null",
  "author_id": "uuid",
  "author_name": "string|null",
  "views": integer,
  "likes": integer,
  "dislikes": integer,
  "comments_count": integer,
  "is_published": boolean,
  "published_at": "datetime|null",
  "created_at": "timestamp",
  "updated_at": "timestamp"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>26. Create News</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/news</code></p>
            <p><strong>Description:</strong> Creates a new news article.</p>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "title": "string",
  "content": "string",
  "author_id": "uuid",
  "image": "string|null",
  "views": integer,
  "likes": integer,
  "dislikes": integer,
  "comments_count": integer,
  "is_published": boolean,
  "published_at": "datetime|null"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "News created successfully",
  "id": "uuid"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>27. Update News</h3>
            <p><strong>Method:</strong> PUT</p>
            <p><strong>URL:</strong> <code>/news/{id}</code></p>
            <p><strong>Description:</strong> Updates an existing news article.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the news article</td></tr>
            </table>
            <p><strong>Body:</strong> (application/json)</p>
            <pre>
{
  "title": "string",
  "content": "string",
  "author_id": "uuid",
  "image": "string|null",
  "views": integer,
  "likes": integer,
  "dislikes": integer,
  "comments_count": integer,
  "is_published": boolean,
  "published_at": "datetime|null"
}
            </pre>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "News updated successfully"
}
            </pre>
        </div>

        <div class="endpoint">
            <h3>28. Delete News</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/news/{id}</code></p>
            <p><strong>Description:</strong> Deletes a news article.</p>
            <p><strong>Parameters:</strong></p>
            <table>
                <tr><th>Name</th><th>Type</th><th>Description</th></tr>
                <tr><td>id</td><td>UUID</td><td>The UUID of the news article</td></tr>
            </table>
            <p><strong>Response:</strong></p>
            <pre>
{
  "message": "News deleted successfully"
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>Error Responses</h2>
        <div class="endpoint">
            <p><strong>400 Bad Request:</strong></p>
            <pre>
{
  "error": "Invalid input data"
}
            </pre>
            <p><strong>404 Not Found:</strong></p>
            <pre>
{
  "error": "Resource not found"
}
            </pre>
            <p><strong>500 Internal Server Error:</strong></p>
            <pre>
{
  "error": "Error message"
}
            </pre>
        </div>
    </div>

    <div class="section">
        <h2>Notes</h2>
        <div class="note">
            <ul>
                <li>All endpoints support CORS for cross-origin requests.</li>
                <li>UUIDs are used for IDs (36-character strings).</li>
                <li>Required fields:
                    <ul>
                        <li>POST <code>/anime</code>: <code>title</code>, <code>release_year</code></li>
                        <li>POST <code>/episodes</code>: <code>anime_id</code>, <code>title</code>, <code>video_url</code></li>
                        <li>POST <code>/users</code>: <code>username</code>, <code>email</code>, <code>password</code></li>
                        <li>POST <code>/favorites</code>: <code>user_id</code>, <code>anime_id</code></li>
                        <li>POST <code>/news</code>: <code>title</code>, <code>content</code>, <code>author_id</code></li>
                        <li>GET <code>/search</code>: <code>q</code> (query parameter)</li>
                    </ul>
                </li>
                <li>The API uses the database schema provided in <code>c576_voiplay.sql</code>.</li>
                <li>Deploy the files in a directory structure: <code>api.voiplay.uz/api/v3/</code>.</li>
                <li>Ensure the MySQL database is configured with the correct credentials in <code>config.php</code>.</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>Testing the API</h2>
        <p>Below are example cURL commands and a PHP script to test the API endpoints.</p>

        <h3>cURL Commands</h3>
        <div class="endpoint">
            <h4>Test Get All Anime</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/anime
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Get Anime with Filters</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/anime?status=ongoing&release_year=2025&rating=8.0&genres=Action,Adventure
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Get Ongoing Anime</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/anime/ongoing
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Create Anime</h4>
            <pre>
curl -X POST https://api.voiplay.uz/api/v3/anime \
-H "Content-Type: application/json" \
-d '{
    "title": "Test Anime",
    "release_year": 2025,
    "description": "A test anime series",
    "status": "ongoing",
    "genres": ["Action", "Adventure"]
}'
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Get Episode by ID</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/episodes/123e4567-e89b-12d3-a456-426614174000
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Create Episode</h4>
            <pre>
curl -X POST https://api.voiplay.uz/api/v3/episodes \
-H "Content-Type: application/json" \
-d '{
    "anime_id": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Episode 1",
    "video_url": "https://example.com/video.mp4",
    "episode_number": 1,
    "content_maker_id": "456e7890-e12f-34d5-a678-901234567890"
}'
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Create User</h4>
            <pre>
curl -X POST https://api.voiplay.uz/api/v3/users \
-H "Content-Type: application/json" \
-d '{
    "username": "testuser",
    "email": "test@example.com",
    "password": "securepassword"
}'
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Create Favorite</h4>
            <pre>
curl -X POST https://api.voiplay.uz/api/v3/favorites \
-H "Content-Type: application/json" \
-d '{
    "user_id": "123e4567-e89b-12d3-a456-426614174000",
    "anime_id": "456e7890-e12f-34d5-a678-901234567890"
}'
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Get User Favorites</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/users/123e4567-e89b-12d3-a456-426614174000/favorites
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Search</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/search?q=attack
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Create News</h4>
            <pre>
curl -X POST https://api.voiplay.uz/api/v3/news \
-H "Content-Type: application/json" \
-d '{
    "title": "New Anime Release",
    "content": "A new anime is coming soon!",
    "author_id": "123e4567-e89b-12d3-a456-426614174000",
    "is_published": true
}'
            </pre>
        </div>
        <div class="endpoint">
            <h4>Test Get All News</h4>
            <pre>
curl https://api.voiplay.uz/api/v3/news
            </pre>
        </div>

        <h3>PHP Test Script</h3>
        <p>Save the following script as <code>test_api.php</code> and run it to test the API endpoints. Update the <code>$baseUrl</code> and UUIDs as needed.</p>
        <pre>
&lt;?php
$baseUrl = 'https://api.voiplay.uz/api/v3';

function makeRequest($method, $url, $data = null) {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $method);
    curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
    
    if ($data) {
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
    }
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    echo "Request: $method $url\n";
    echo "Response Code: $httpCode\n";
    echo "Response: $response\n\n";
}

// Test Get All Anime
makeRequest('GET', "$baseUrl/anime");

// Test Get Anime with Filters
makeRequest('GET', "$baseUrl/anime?status=ongoing&release_year=2025&rating=8.0&genres=Action,Adventure");

// Test Get Ongoing Anime
makeRequest('GET', "$baseUrl/anime/ongoing");

// Test Create Anime
makeRequest('POST', "$baseUrl/anime", [
    'title' => 'Test Anime',
    'release_year' => 2025,
    'description' => 'A test anime series',
    'status' => 'ongoing',
    'genres' => ['Action', 'Adventure']
]);

// Test Create Episode
makeRequest('POST', "$baseUrl/episodes", [
    'anime_id' => '123e4567-e89b-12d3-a456-426614174000',
    'title' => 'Episode 1',
    'video_url' => 'https://example.com/video.mp4',
    'episode_number' => 1,
    'content_maker_id' => '456e7890-e12f-34d5-a678-901234567890'
]);

// Test Create User
makeRequest('POST', "$baseUrl/users", [
    'username' => 'testuser' . rand(1000, 9999),
    'email' => 'test' . rand(1000, 9999) . '@example.com',
    'password' => 'securepassword'
]);

// Test Create Favorite
makeRequest('POST', "$baseUrl/favorites", [
    'user_id' => '123e4567-e89b-12d3-a456-426614174000',
    'anime_id' => '456e7890-e12f-34d5-a678-901234567890'
]);

// Test Get User Favorites
makeRequest('GET', "$baseUrl/users/123e4567-e89b-12d3-a456-426614174000/favorites");

// Test Search
makeRequest('GET', "$baseUrl/search?q=attack");

// Test Create News
makeRequest('POST', "$baseUrl/news", [
    'title' => 'New Anime Release',
    'content' => 'A new anime is coming soon!',
    'author_id' => '123e4567-e89b-12d3-a456-426614174000',
    'is_published' => true
]);

// Test Get All News
makeRequest('GET', "$baseUrl/news");
?&gt;
        </pre>
        <p><strong>Running the Test Script:</strong></p>
        <p>1. Save the script as <code>test_api.php</code>.</p>
        <p>2. Ensure PHP and cURL are installed.</p>
        <p>3. Update UUIDs in the script to match existing records in your database.</p>
        <p>4. Run the script: <code>php test_api.php</code></p>
        <p>The script will output the response code and body for each request.</p>
    </div>
    <div class="section">
        <h2>Auth</h2>
        <div class="endpoint">
            <h3>Login</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/auth/login</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "email": "string (or username)", "password": "string" }</pre>
            <p><strong>Response:</strong></p>
            <pre>{ "access_token": "string", "refresh_token": "string", "expires_in": integer, "refresh_ttl": integer }</pre>
            <p><strong>Description:</strong> Returns an access JWT (short-lived) and a refresh token with a <strong>sliding inactivity window</strong>. The refresh token TTL is returned as <code>refresh_ttl</code> in seconds (default: 30 days). If there are no authenticated requests with the token within that window, the session is invalidated and the user must log in again.</p>
        </div>

        <div class="endpoint">
            <h3>Refresh Token Rotation</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/auth/refresh</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "refresh_token": "string" }</pre>
            <p><strong>Response:</strong></p>
            <pre>{ "access_token": "string", "refresh_token": "string", "expires_in": integer, "refresh_ttl": integer }</pre>
            <p><strong>Description:</strong> Exchanges a valid refresh token for a new access + refresh token. Both the client and server implement a sliding inactivity window: the refresh token's <code>expires_at</code> is extended to <code>now + refresh_ttl</code> whenever the client makes an authenticated request (sends a valid access token) or when a refresh is performed.</p>
        </div>
    </div>

    <div class="section">
        <h2>Favorites (CRUD)</h2>
        <div class="endpoint">
            <h3>List Favorites</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/favorites</code></p>
        </div>
        <div class="endpoint">
            <h3>Create Favorite</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/favorites</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid", "anime_id": "uuid" }</pre>
            <p><strong>Notes:</strong> If <code>user_id</code> is omitted, you can send an <code>Authorization: Bearer &lt;access_token&gt;</code> header and the server will authenticate the request and use the token's user. Tokens are extended on each authenticated request (sliding 30-day inactivity window).</p>
        </div>
        <div class="endpoint">
            <h3>Update Favorite</h3>
            <p><strong>Method:</strong> PUT</p>
            <p><strong>URL:</strong> <code>/favorites/{id}</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid", "anime_id": "uuid" }</pre>
        </div>
        <div class="endpoint">
            <h3>Delete Favorite</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/favorites/{id}</code></p>
        </div>
    </div>

    <div class="section">
        <h2>Interactions</h2>
        <div class="endpoint">
            <h3>Like Episode</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/interactions/episodes/{id}/like</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid" }</pre>
        </div>
        <div class="endpoint">
            <h3>Dislike Episode</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/interactions/episodes/{id}/dislike</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid" }</pre>
        </div>
    </div>

    <div class="section">
        <h2>Comments</h2>
        <div class="endpoint">
            <h3>Get Comments for Anime</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/anime/{id}/comment</code></p>
        </div>
        <div class="endpoint">
            <h3>Add Comment</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/anime/{id}/comment</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid", "content": "string" }</pre>
        </div>
        <div class="endpoint">
            <h3>Edit Comment</h3>
            <p><strong>Method:</strong> PUT</p>
            <p><strong>URL:</strong> <code>/comments/{id}</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid", "content": "string" }</pre>
        </div>
        <div class="endpoint">
            <h3>Delete Comment</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/comments/{id}</code></p>
            <p><strong>Body (optional):</strong></p>
            <pre>{ "user_id": "uuid" }</pre>
        </div>
    </div>

    <div class="section">
        <h2>Devices</h2>
        <div class="endpoint">
            <h3>Get User Devices</h3>
            <p><strong>Method:</strong> GET</p>
            <p><strong>URL:</strong> <code>/users/{id}/devices</code></p>
        </div>
        <div class="endpoint">
            <h3>Revoke Device</h3>
            <p><strong>Method:</strong> DELETE</p>
            <p><strong>URL:</strong> <code>/devices/{id}</code></p>
        </div>
    </div>

    <div class="section">
        <h2>Promocodes</h2>
        <div class="endpoint">
            <h3>Check Promocode</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/promocodes/check</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "code": "string" }</pre>
        </div>
        <div class="endpoint">
            <h3>Apply Promocode</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/promocodes/apply</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "code": "string", "user_id": "uuid" }</pre>
        </div>
    </div>

    <div class="section">
        <h2>Reports</h2>
        <div class="endpoint">
            <h3>Submit Report</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/reports</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid", "target_type": "string", "target_id": "uuid", "reason": "string", "details": "string|null" }</pre>
        </div>
    </div>

    <div class="section">
        <h2>Views</h2>
        <div class="endpoint">
            <h3>Increment View</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/episodes/{id}/view</code></p>
            <p><strong>Body (optional):</strong></p>
            <pre>{ "user_id": "uuid" }</pre>
        </div>
    </div>

    <div class="section">
        <h2>Watch History</h2>
        <div class="endpoint">
            <h3>Save / Update Watch History</h3>
            <p><strong>Method:</strong> POST</p>
            <p><strong>URL:</strong> <code>/watch-history</code></p>
            <p><strong>Body:</strong></p>
            <pre>{ "user_id": "uuid", "anime_id": "uuid", "episode_id": "uuid", "progress": "number" }</pre>
        </div>
    </div>

    <div class="section">
        <h2>Database</h2>
        <div class="endpoint">
            <h3>Refresh Tokens Table</h3>
            <p><strong>SQL:</strong></p>
            <pre>CREATE TABLE `refresh_tokens` (
  `id` varchar(36) NOT NULL,
  `user_id` varchar(36) NOT NULL,
  `token_hash` char(64) NOT NULL,
  `expires_at` datetime NOT NULL,
  `revoked` tinyint(1) NOT NULL DEFAULT '0',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uq_token_hash` (`token_hash`),
  KEY `idx_user_id` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;</pre>
        </div>
    </div>
</body>
</html>